<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>관리자 페이지 - Together</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .admin-header {
            background: linear-gradient(135deg, #dc3545 0%, #6f42c1 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }
        .stat-card {
            border-radius: 15px;
            transition: transform 0.3s;
            border: none;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        .admin-card {
            border-radius: 10px;
            border-left: 4px solid #dc3545;
            transition: all 0.3s;
        }
        .admin-card:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            cursor: pointer;
        }
        .quick-action-btn {
            border-radius: 10px;
            padding: 0.75rem 1.5rem;
            margin: 0.5rem;
            transition: all 0.3s;
        }
        .chart-container {
            height: 300px;
            position: relative;
        }
        .activity-item {
            border-left: 3px solid #6c757d;
            padding-left: 1rem;
            margin-bottom: 1rem;
        }
        .activity-item.recent {
            border-left-color: #28a745;
        }
        .activity-item.warning {
            border-left-color: #ffc107;
        }
        .activity-item.danger {
            border-left-color: #dc3545;
        }
        .sidebar {
            background-color: #f8f9fa;
            min-height: calc(100vh - 200px);
            border-radius: 10px;
        }
        .nav-item {
            margin-bottom: 0.5rem;
        }
        .nav-link {
            color: #495057;
            border-radius: 8px;
            transition: all 0.3s;
        }
        .nav-link:hover {
            background-color: #e9ecef;
            color: #dc3545;
        }
        .nav-link.active {
            background-color: #dc3545;
            color: white;
        }
    </style>
</head>
<body>
<!-- Admin Header -->
<div class="admin-header">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-md-8">
                <h2><i class="fas fa-shield-alt me-2"></i>관리자 대시보드</h2>
                <p class="mb-0">Together 플랫폼 전체 현황을 관리하세요</p>
            </div>
            <div class="col-md-4 text-end">
                <div class="dropdown">
                    <button class="btn btn-light dropdown-toggle" type="button" data-bs-toggle="dropdown">
                        <i class="fas fa-user-shield"></i> 관리자님
                    </button>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="/mypage">마이페이지</a></li>
                        <li><a class="dropdown-item" href="/main">사용자 모드</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="/logout">로그아웃</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container-fluid">
    <div class="row">
        <!-- Sidebar -->
        <div class="col-md-2">
            <div class="sidebar p-3">
                <nav class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link active" href="/manager/manager">
                            <i class="fas fa-tachometer-alt me-2"></i>대시보드
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/manager/mUser">
                            <i class="fas fa-users me-2"></i>회원 관리
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/manager/mCafe">
                            <i class="fas fa-coffee me-2"></i>카페 관리
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/manager/mTrade">
                            <i class="fas fa-shopping-cart me-2"></i>거래 관리
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/manager/mMeeting">
                            <i class="fas fa-calendar-alt me-2"></i>모임 관리
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/manager/mReport">
                            <i class="fas fa-exclamation-triangle me-2"></i>신고 관리
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/manager/mStats">
                            <i class="fas fa-chart-bar me-2"></i>통계 관리
                        </a>
                    </li>
                </nav>
            </div>
        </div>

        <!-- Main Content -->
        <div class="col-md-10">
            <!-- Statistics Cards -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="card stat-card bg-primary text-white">
                        <div class="card-body text-center">
                            <i class="fas fa-users fa-3x mb-3"></i>
                            <h2 th:text="${totalUsers ?: 1245}">1,245</h2>
                            <p class="mb-0">총 회원수</p>
                            <small class="opacity-75">+12% 이번 달</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card stat-card bg-success text-white">
                        <div class="card-body text-center">
                            <i class="fas fa-coffee fa-3x mb-3"></i>
                            <h2 th:text="${totalCafes ?: 89}">89</h2>
                            <p class="mb-0">활성 카페</p>
                            <small class="opacity-75">+5 새로운 카페</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card stat-card bg-info text-white">
                        <div class="card-body text-center">
                            <i class="fas fa-handshake fa-3x mb-3"></i>
                            <h2 th:text="${totalTrades ?: 456}">456</h2>
                            <p class="mb-0">총 거래</p>
                            <small class="opacity-75">+23 오늘</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card stat-card bg-warning text-white">
                        <div class="card-body text-center">
                            <i class="fas fa-calendar-check fa-3x mb-3"></i>
                            <h2 th:text="${totalMeetings ?: 178}">178</h2>
                            <p class="mb-0">진행 모임</p>
                            <small class="opacity-75">+8 이번 주</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card admin-card">
                        <div class="card-header">
                            <h5><i class="fas fa-bolt me-2"></i>빠른 작업</h5>
                        </div>
                        <div class="card-body text-center">
                            <a href="/manager/mUser" class="btn btn-outline-primary quick-action-btn">
                                <i class="fas fa-user-plus"></i> 신규 회원 승인
                            </a>
                            <a href="/manager/mCafe" class="btn btn-outline-success quick-action-btn">
                                <i class="fas fa-coffee"></i> 카페 신청 검토
                            </a>
                            <a href="/manager/mReport" class="btn btn-outline-warning quick-action-btn">
                                <i class="fas fa-flag"></i> 신고 처리
                            </a>
                            <a href="/manager/mTrade" class="btn btn-outline-info quick-action-btn">
                                <i class="fas fa-shopping-cart"></i> 거래 모니터링
                            </a>
                            <button class="btn btn-outline-danger quick-action-btn" onclick="sendNotification()">
                                <i class="fas fa-bell"></i> 전체 공지
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Charts and Activity -->
            <div class="row">
                <!-- Chart Section -->
                <div class="col-md-8">
                    <div class="card admin-card">
                        <div class="card-header">
                            <h5><i class="fas fa-chart-line me-2"></i>플랫폼 활동 현황</h5>
                        </div>
                        <div class="card-body">
                            <div class="chart-container">
                                <canvas id="activityChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="col-md-4">
                    <div class="card admin-card">
                        <div class="card-header">
                            <h5><i class="fas fa-history me-2"></i>최근 활동</h5>
                        </div>
                        <div class="card-body" style="max-height: 350px; overflow-y: auto;">
                            <div class="activity-item recent">
                                <h6 class="mb-1">새로운 카페 신청</h6>
                                <small class="text-muted">독서 모임 카페 - 5분 전</small>
                            </div>
                            <div class="activity-item recent">
                                <h6 class="mb-1">신규 회원 가입</h6>
                                <small class="text-muted">user1234 - 12분 전</small>
                            </div>
                            <div class="activity-item warning">
                                <h6 class="mb-1">신고 접수</h6>
                                <small class="text-muted">거래 관련 신고 - 1시간 전</small>
                            </div>
                            <div class="activity-item recent">
                                <h6 class="mb-1">모임 개최</h6>
                                <small class="text-muted">음악 감상 모임 - 2시간 전</small>
                            </div>
                            <div class="activity-item danger">
                                <h6 class="mb-1">계정 정지</h6>
                                <small class="text-muted">약관 위반 사용자 - 3시간 전</small>
                            </div>
                            <div class="activity-item recent">
                                <h6 class="mb-1">거래 성사</h6>
                                <small class="text-muted">전자기기 거래 완료 - 4시간 전</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Management Summary -->
            <div class="row mt-4">
                <div class="col-md-6">
                    <div class="card admin-card">
                        <div class="card-header">
                            <h5><i class="fas fa-exclamation-circle me-2"></i>처리 대기 항목</h5>
                        </div>
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span>카페 신청 검토</span>
                                <span class="badge bg-warning" th:text="${pendingCafes ?: 3}">3</span>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span>신고 처리</span>
                                <span class="badge bg-danger" th:text="${pendingReports ?: 7}">7</span>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span>계정 복구 요청</span>
                                <span class="badge bg-info" th:text="${pendingRecovery ?: 2}">2</span>
                            </div>
                            <div class="d-flex justify-content-between align-items-center">
                                <span>문의사항</span>
                                <span class="badge bg-secondary" th:text="${pendingInquiry ?: 5}">5</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card admin-card">
                        <div class="card-header">
                            <h5><i class="fas fa-server me-2"></i>시스템 상태</h5>
                        </div>
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span>서버 상태</span>
                                <span class="badge bg-success">정상</span>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span>데이터베이스</span>
                                <span class="badge bg-success">연결됨</span>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span>CPU 사용률</span>
                                <span class="badge bg-warning">67%</span>
                            </div>
                            <div class="d-flex justify-content-between align-items-center">
                                <span>메모리 사용률</span>
                                <span class="badge bg-info">45%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // Activity Chart
    const ctx = document.getElementById('activityChart').getContext('2d');
    const activityChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: ['1월', '2월', '3월', '4월', '5월', '6월'],
            datasets: [{
                label: '신규 회원',
                data: [65, 59, 80, 81, 56, 95],
                borderColor: 'rgb(75, 192, 192)',
                tension: 0.1
            }, {
                label: '신규 카페',
                data: [28, 48, 40, 19, 86, 27],
                borderColor: 'rgb(255, 99, 132)',
                tension: 0.1
            }, {
                label: '거래량',
                data: [35, 67, 58, 93, 44, 78],
                borderColor: 'rgb(54, 162, 235)',
                tension: 0.1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });

    // Send Notification Function
    function sendNotification() {
        const message = prompt('전체 사용자에게 보낼 공지사항을 입력하세요:');
        if (message) {
            // API 호출 로직
            alert('공지사항이 전송되었습니다: ' + message);
        }
    }

    // Auto refresh data every 30 seconds
    setInterval(function() {
        // 실시간 데이터 갱신 로직
        console.log('데이터 갱신 중...');
    }, 30000);
</script>
</body>
</html>